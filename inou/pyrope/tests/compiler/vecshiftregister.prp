$io.ins.0.__ubits = 4
$io.ins.1.__ubits = 4
$io.load.__sbits = 1
$io.shift.__sbits = 1

$reset.__sbits = 1 // To keep reset as input

// %io.out.__ubits = 4  // This is redundant, inferred at compile time

delays = delays.__create_flop
delays.__reset = 0  // shared across all delays flops
delays.0.__reset = 0 // not needed but OK too

// delays.1.__reset = 0
delays_q = delays
delays[0].__ubits = 4  // This is the same as next but entry 0
delays.1.__ubits = 4

if $io.load {
  delays[0] = $io.ins[0]
  delays[1] = $io.ins[1]
}elif $io.shift {
  delays[0] = $io.ins[0]
  delays[1] = delays_q[0]
}

%io.out = delays_q[1]
